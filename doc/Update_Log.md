# Update log for x900 project

## v2.3
* 优化定位精度。

## v2.2
2018.02.28
* 修复暂停时抬起机器不会退出清扫的bug。
* 修复充电座唤醒进入回充对位过程中无法进入自救的bug。
* 修复偶尔无法从充电座下来开始自动清扫的bug。
* 增加遥控模式下的异常自救动作。
* 修复bumper后两段自救动作，旋转为90度。
* 修复风扇自救动作。
* 修复开机对齐直线功能。
* 修复沿墙碰撞后对齐直线功能。
* 优化用雷达检测前方障碍物功能。
* 修复路径规划。
* 修复同一行重复清扫。
* rivz地图打印路径。
* 增加r16部分测试功能（扬声器、串口、RAM）。
* 修复待机低电进入遥控模式后电量充足的bug。
* 修改脱困时bumper撞到后的转角大小。
* 修复获取错误的雷达补偿数据的bug。
* 修复沿墙时死机的bug。
* 优化雷达沿墙功能(现离墙足够近才会旋转)。
* 优化陀螺仪动态调整。
* 修复暂停清扫超时进入休眠模式时语音被打断以及唤醒类似死机问题。
* 遥控模式下增加吸力切换功能。
* 遥控模式下插入充电线直接停机开始充电。

## v2.1
2018.01.25
* 修复重复播放“进入重点清扫模式”语音的bug
* 增加遥控模式下躲避充电座功能。
* 增加r16低功耗模式。
* 修复待机10分钟不进入休眠bug。
* 优化障碍探测减速逻辑。
* 修复遥控模式下旋转异常逻辑。
* 修复遥控模式下直行遇到障碍不减速的bug。
* 机器初始化时led闪烁周期改为0.6秒。
* 加入沿墙动作躲避充电座功能。
* 增加充电完成后绿灯提示60秒，然后进入休眠模式。
* 更改到达预约时间时若有报警信息的处理。
* 增加机器被抬起时的后退动作。
* 增加在重点清扫，按下方向和暂停键退出清扫功能,增加按下回充和沿墙按键，进入相应模式功能。
* 增加滚刷过流检测，和自救动作。
* 修复沿墙清扫模式初始直走时按遥控回充直接停机的bug。
* 增加电源开关的检测，电源开关关闭情况下放在充电座上按AUTO键会有开关的提示。
* 增加正常规划清扫暂停时用遥控切换到重点清扫模式的逻辑。
* 增加重点清扫和清扫模式下爬充电座对位过程中的过流检测。

## v2.0
2018.01.15
* 重构代码，从C架构移植到C++架构

## v1.6
2017.10.25

* 打滑增加自救动作
* 雷达bumper
* 底层板更新
* 轮速加PID
* 换行后用雷达看两边哪边比较近就先去哪边
* 直线和沿墙标点统一
* 沿墙转角度算法。
* 沿墙动作优化
* 优化雷达数据使用
* 后退过程用雷达探测后方是否可以后退。
* 雷达探测后方能否后退
* 待机唤醒爬充电座放入regulator
* 充电过程中turn_connect失败才进行后退。
* 沿墙雷达标点距离缩短
* 调整雷达位置数据
* Cliff Bumper急刹车
* 倾斜的地方不沿墙
* 沿墙传感器动态调整算法
* 停顿给陀螺仪调整

## v1.5
2017.09.25
* 雷达代替万向轮检测，增加自救动作。
* ROS_INFO和printf消耗对比。
* 长时间充电放电出现process died问题。
* 绕充电座走法。
* 刹车过不过PID优化。
* 沿墙目标点不可去的时候及时结束。
* 沿墙不停止直到形状返回或者已清扫。
* 多转折点的时候不沿墙。
* 尝试用其他方法计算是否脱困成功。
* 沿墙判别条件优化。
* 沿墙obs只做减速。
* 脱困动作优化。
* 脱困发生时根据左右bumper决定左右沿墙（已撤销）。
* rplidar用topic控制发不发。
* 蛇形行走bug。
* 整合爬充电座动作到regulator， 配合探索充电座走法。
* 拆分path_target()， 减少脱困时计算是否脱困成功的用时。
* Bug 445，长时间工作死机问题。
* 探索充电座。

## v1.4
2017.09.01

* 原地旋转最高速从17调到20。
* 改为非实时mark点。
* 解决同一行多次清扫问题。
* 加入脱困孤岛检测。
* 加入脱困闭合检测。
* 曲线行走。
* 减缓定位跳动算法。
* 优化倾斜检测的逻辑。
* 优化重点清扫的算法。
* 优化沿墙动作。
* 底层优化充电座唤醒逻辑。
* 增加回充时困死处理，增加回充成功几率。

## v1.3
2017.08.10

* 修改爬充电座过程中判断距离充电座远近的逻辑。
* 优化倾斜检测的逻辑。
* 增加新的标点方式：使用镭射标点，OBS只做减速。在config.h里修改LASER_MARKER即可切换。
* 修复初始化过程中暂停然后直接进入回充导致进程出错的bug。
* 增加新的调整走直线方式：让机器一直沿着目标行的中心点所在的线做PID调速。在config.h里修改FORCE_MOVE_LINE即可切换。
* 修改slam_karto的参数，优化性能。
* 修改bumper标点方式，只在前面三格里面选标。
* 增加充电座脱落时自动恢复。
* 上层板供电逻辑采用软件滞回比较器。
* 边轮调速逻辑修改：当接收到两个边轮的目标速度均为0时（即停机），边轮不经过PID调速而是直接将速度置为0。
* 沿墙结束条件优化，加快结束检测速度。

## v1.2
2017.08.03

* 底层优化灯条无法开启的bug。
* 优化Rcon的障碍标记。
* 优化太贴近充电座时动作，先往后走一段再爬充电座。
* 修复脱困时进入和退出的条件带来的bug。
* 优化遥控模式下躲避充电座的表现。
* 优化回充动作。
* 修复休眠唤醒时的事件优先级带来的bug。
* 回home point过程中若看见充电座信号，可以直接尝试爬充电座。
* 修复雷达开启过程中按clean键产生的bug。
* 修复规划清扫时cliff无限前进后退的bug。
* 原地旋转最高速从17调到22。（无效）
